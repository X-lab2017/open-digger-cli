# open-digger-cli

> ğŸ“ˆ ä¸€ä¸ªæŸ¥è¯¢ [open-digger][1] æŒ‡æ ‡çš„ CLI å·¥å…·ã€‚

ğŸ“º B ç«™è§†é¢‘ï¼š[[OpenSODA]open-digger-cli](https://www.bilibili.com/video/BV1YG411m73S/)

## ğŸ’¡ åŠŸèƒ½ & è·¯çº¿å›¾

- âœ… åŸºç¡€çš„æŒ‡æ ‡æŸ¥è¯¢ï¼Œæ”¯æŒæŒ‡å®šç‰¹å®šçš„æŒ‡æ ‡ã€æ—¶é—´èŒƒå›´ã€‚
- âœ… ç”Ÿæˆ pdf æŠ¥å‘Šï¼Œæ”¯æŒæŒ‡å®šç‰¹å®šçš„æŒ‡æ ‡ã€æ—¶é—´èŒƒå›´ã€‚
- âœ… æ”¯æŒå¯¹è¯å¼äº¤äº’ï¼Œä½¿ç”¨æ›´å‹å¥½ã€‚
- ğŸš§<sup style="color: red;">\*</sup> æ”¯æŒæ›´å¤šçš„æŠ¥å‘Šè¾“å‡ºæ ¼å¼ã€‚
- ğŸš§<sup style="color: red;">\*</sup> ä¸ºç”ŸæˆæŠ¥å‘Šæ·»åŠ **æ’ä»¶ç³»ç»Ÿ**ï¼Œè®©ä½¿ç”¨è€…è‡ªå®šä¹‰æ›´å¤šå†…å®¹ã€‚
- âœ… ä¸ºå‘½ä»¤è¡ŒæŸ¥è¯¢å·¥å…·æ·»åŠ **æ’ä»¶ç³»ç»Ÿ**ï¼Œè®©ä½¿ç”¨è€…è‡ªå®šä¹‰æ›´å¤šå†…å®¹ã€‚

## ğŸ§¶ è®¾è®¡æ€è·¯

å‘½ä»¤è¡Œè·å–å‘½ä»¤å’Œå‚æ•°åï¼Œè§£ææ•°æ®ï¼Œæ ¹æ®å­å‘½ä»¤æ‰§è¡Œä¸åŒæ“ä½œï¼ˆåœ¨æ‰§è¡Œæ“ä½œå‰ä¼šå‘ open-digger æä¾›çš„æ•°æ®æœåŠ¡è¿›è¡Œæ•°æ®æ‹‰å–ï¼‰ï¼š

æ•°æ®æŸ¥è¯¢åŠŸèƒ½ï¼šå°†è·å–çš„æ•°æ®æ‰“å°åˆ°å‘½ä»¤è¡Œå·¥å…·ï¼›

æ•°æ®å¯¼å‡ºåŠŸèƒ½ï¼šå°†è·å–çš„æ•°æ®æ ¹æ®å‘½ä»¤ï¼Œä½¿ç”¨ä¸åŒçš„å¼•æ“è¿›è¡Œæ¸²æŸ“ï¼Œå†è¿›è¡Œä¸åŒå½¢å¼çš„å¯¼å‡ºã€‚

åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œopen-digger-cli è®¡åˆ’æä¾›ä¸°å¯Œçš„ hookï¼Œä»¥ä¾¿ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œæ•°æ®å±•ç¤ºã€‚

## ğŸ’£ å®ç°éš¾ç‚¹

1. æ”¯æŒ `json`ã€`yml` ç­‰é…ç½®æ–‡ä»¶éš¾åº¦è¾ƒä½ï¼Œä½†å¯æ‹“å±•æ€§æœ‰é™ï¼›ç›®å‰è®¡åˆ’æ”¯æŒ `js`ã€`mjs` ç­‰é…ç½®æ–‡ä»¶ï¼Œå¢å¼ºè½¯ä»¶çš„å¯æ‹“å±•æ€§ï¼Œä½†éš¾åº¦è¾ƒä¹‹å‰å¤§å¤§æé«˜ã€‚

2. ç›®å‰è®¡åˆ’æ”¯æŒ pdf å¯¼å‡ºï¼Œæ•°æ®ä¼ é€’åŠæ•°æ®å±•ç¤ºéš¾åº¦éƒ½è¾ƒå¤§ï¼Œpdf æŒ‰é¢„æœŸæ ¼å¼å¯¼å‡ºä¹Ÿå…·æœ‰ä¸€å®šå›°éš¾ã€‚

## ğŸ”§ å®‰è£…

æœ¬å·¥å…·åŸºäº Node.jsï¼Œè¯·åœ¨å®‰è£…æœ¬å·¥å…·å‰å®‰è£…å‰ Node.js ç¯å¢ƒã€‚

```bash
npm i -g @stevending1st/open-digger-cli
```

## âŒ¨ï¸ å‘½ä»¤è¡Œä½¿ç”¨

### ç‰ˆæœ¬æŸ¥è¯¢

```bash
digger --version

# æˆ–

digger -v
```

### å¸®åŠ©å‘½ä»¤

#### å…¨å±€å¸®åŠ©

```bash
digger --help

# æˆ–

digger -h
```

**æ³¨ï¼š** ç›®å‰å¯¼å‡ºåŠŸèƒ½è¿˜æœ‰äº›é—®é¢˜ï¼Œå¦‚éœ€ä½“éªŒè¯·æŒ‰ä¸‹é¢æ–¹å¼å®‰è£…ï¼š

```bash
npm rm @stevending1st/open-digger-cli -g
git clone git@github.com:stevending1st/open-digger-cli.git
cd open-digger-cli
npm run dev
npm link
```

å¦‚éœ€å¸è½½è¯·æ‰§è¡Œï¼š

```bash
npm rm @stevending1st/open-digger-cli -g
```

### å­å‘½ä»¤å¸®åŠ©

```bash
digger --help <command>

# æˆ–

digger -h <command>
```

`<command>`: å­å‘½ä»¤ï¼Œç›®å‰æ”¯æŒ `chat`ã€`export`

### æŒ‡æ ‡æŸ¥è¯¢

æŸ¥è¯¢æŒ‡å®šä»“åº“/ç”¨æˆ·çš„æŒ‡æ ‡ã€‚

```bash
digger <example> -m <metrics> [-t <time>]
```

- `<example>`ï¼šæŒ‡å®šä¸€ä¸ªä»“åº“æˆ–è€…ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼š`X-lab2017/open-digger`ã€`stevending1st`ã€‚
- `<metrics>`ï¼šæŒ‡å®šæŸ¥è¯¢çš„æŒ‡æ ‡ï¼Œæ”¯æŒå¤šä¸ªæŒ‡æ ‡ï¼Œå¤šä¸ªæŸ¥è¯¢ç”¨ `,` è¿æ¥ã€‚ä¾‹å¦‚ï¼š`openrank`ã€`openrank activity`ã€‚
  ç›®å‰æ”¯æŒå‚æ•°ï¼š`openrank`ã€`activity`ã€`attention`ã€`active_dates_and_times`ã€`stars`ã€`technical_fork`ã€`participants`ã€`new_contributors`ã€`new_contributors_detail`ã€`inactive_contributors`ã€`bus_factor`ã€`bus_factor_detail`ã€`issues_new`ã€`issues_closed`ã€`issue_comments`ã€`issue_response_time`ã€`issue_resolution_duration`ã€`issue_age`ã€`code_change_lines`ã€`code_change_lines_add`ã€`code_change_lines_remove`ã€`code_change_lines_sum`ã€`change_requests`ã€`change_requests_accepted`ã€`change_requests_reviews`ã€`change_request_response_time`ã€`change_request_resolution_duration`ã€`change_request_age`ã€`activity_details`ã€‚
- `<time>`ï¼šæŸ¥è¯¢çš„æ—¶é—´èŒƒå›´ï¼Œæ ¼å¼ä¸º yyyyMM æˆ– yyyyMM-yyyyMM ã€‚ä¾‹å¦‚ï¼š`202203`ã€`201912-202212`ã€‚

#### æŸ¥è¯¢æŒ‡å®šä»“åº“çš„æŒ‡å®šæŒ‡æ ‡

```bash
digger <example> -m <metrics>
```

ä¾‹å¦‚ï¼š`digger X-lab2017/open-digger -m openrank`

```bash
repo.owner: X-lab2017
repo.name: open-digger
repo.url:https://github.com/X-lab2017/open-digger
repo.openrank:  {
  '2020-08': 3.46,
  '2020-09': 3.7,
  '2020-10': 4.28,
  '2020-11': 5.2,
  '2020-12': 7.82,
  '2021-01': 7.29,
  '2021-02': 4.45,
  '2021-03': 2.95,
  '2021-04': 3.36,
  '2021-05': 3.1,
  '2021-06': 4.78,
  '2021-07': 3.59,
  '2021-08': 2.56,
  '2021-09': 2.18,
  '2021-10': 2,
  '2021-11': 1.88,
  '2021-12': 2.3,
  '2022-01': 3.52,
  '2022-02': 3.55,
  '2022-03': 4.49,
  '2022-04': 2.69,
  '2022-05': 2.88,
  '2022-06': 5.59,
  '2022-07': 6.47,
  '2022-08': 6.01,
  '2022-09': 7.16,
  '2022-10': 9.32,
  '2022-11': 11.82,
  '2022-12': 15.16,
  '2023-01': 15.38,
  '2023-02': 32.22,
  '2023-03': 16.17,
  '2023-04': 13.55,
  '2023-05': 13.42,
  '2023-06': 10.05,
  '2023-07': 10.56,
  '2023-08': 9.83,
  '2023-09': 8.59
}
```

#### æŸ¥è¯¢æŒ‡å®šæ—¶é—´èŒƒå›´çš„æŒ‡å®šä»“åº“çš„æŒ‡å®šæŒ‡æ ‡

```bash
digger <example> -m <metrics> -t <time>
```

ä¾‹å¦‚ï¼š`digger X-lab2017/open-digger -m openrank stars -t 202201-202206`

```bash
repo.owner: X-lab2017
repo.name: open-digger
repo.url:https://github.com/X-lab2017/open-digger
month: 202201-202206
repo.openrank:  {
  '2022-01': 3.52,
  '2022-02': 3.55,
  '2022-03': 4.49,
  '2022-04': 2.69,
  '2022-05': 2.88,
  '2022-06': 5.59
}
repo.stars:  {
  '2022-01': 5,
  '2022-02': 5,
  '2022-03': 102,
  '2022-04': 3,
  '2022-05': 4,
  '2022-06': 1
}
```

#### æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„æŒ‡å®šæŒ‡æ ‡

```bash
digger <example> -m <metrics>
```

ä¾‹å¦‚ï¼š`digger stevending1st -m openrank`

```bash
user: stevending1st
repo.url:https://github.com/stevending1st
user.openrank:  {
  '2017-01': 0.66,
  '2017-02': 0.56,
  '2017-03': 0.48,
  '2017-04': 0.4,
  '2017-05': 0.34,
  '2017-06': 0.29,
  '2017-07': 0.25,
  '2017-08': 0.21,
  '2017-09': 0.18,
  '2017-10': 0.15,
  '2017-11': 0.13,
  '2017-12': 0.11,
  '2018-01': 0.09,
  '2018-02': 0.08,
  '2018-03': 0.07,
  '2018-04': 0.06,
  '2018-05': 0.05,
  '2018-06': 0.04,
  '2018-07': 0.35,
  '2018-08': 0.3,
  '2018-09': 0.26,
  '2018-10': 0.22,
  '2018-11': 0.18,
  '2018-12': 0.16,
  '2019-01': 0.13,
  '2019-02': 0.11,
  '2019-03': 0.1,
  '2019-04': 0.08,
  '2019-05': 0.07,
  '2019-06': 0.06,
  '2019-07': 0.05,
  '2019-08': 0.37,
  '2019-09': 0.31,
  '2019-10': 0.27,
  '2019-11': 0.23,
  '2019-12': 0.19,
  '2020-01': 0.46,
  '2020-02': 0.39,
  '2020-03': 0.33,
  '2020-04': 0.22,
  '2020-05': 0.19,
  '2020-06': 0.16,
  '2020-07': 0.14,
  '2020-08': 0.12,
  '2020-09': 0.1,
  '2020-10': 0.25,
  '2020-11': 0.28,
  '2020-12': 0.24,
  '2021-01': 0.31,
  '2021-02': 0.26,
  '2021-03': 0.89,
  '2021-04': 1.29,
  '2021-05': 1.35,
  '2021-06': 1.62,
  '2021-07': 1.69,
  '2021-08': 3.01,
  '2021-09': 2.8,
  '2021-10': 2,
  '2021-11': 2.18,
  '2021-12': 1.85,
  '2022-01': 1.71,
  '2022-02': 2.98,
  '2022-03': 3.73,
  '2022-04': 2.13,
  '2022-05': 1.64,
  '2022-06': 1.37,
  '2022-07': 0.9,
  '2022-08': 0.54,
  '2022-09': 1.45,
  '2022-10': 3.16,
  '2022-11': 2.53,
  '2022-12': 1.97,
  '2023-01': 1.41,
  '2023-02': 2.48,
  '2023-03': 1.44,
  '2023-04': 2.67,
  '2023-05': 2.44,
  '2023-06': 2.81,
  '2023-07': 3.4,
  '2023-08': 2.05,
  '2023-09': 1.97
}
```

#### æŸ¥è¯¢æŒ‡å®šæ—¶é—´èŒƒå›´çš„æŒ‡å®šç”¨æˆ·çš„æŒ‡å®šæŒ‡æ ‡

```bash
digger <example> -m <metrics> -t <time>
```

ä¾‹å¦‚ï¼š`digger stevending1st -m openrank -t 202101-202112`

```bash
user: stevending1st
repo.url:https://github.com/stevending1st
month: 202101-202112
user.openrank:  {
  '2021-01': 0.31,
  '2021-02': 0.26,
  '2021-03': 0.89,
  '2021-04': 1.29,
  '2021-05': 1.35,
  '2021-06': 1.62,
  '2021-07': 1.69,
  '2021-08': 3.01,
  '2021-09': 2.8,
  '2021-10': 2,
  '2021-11': 2.18,
  '2021-12': 1.85
}
```

#### è¿‡æ»¤æŒ‡å®šæ¥æºçš„æŒ‡æ ‡

```bash
digger <example> -f <from>
```

ä¾‹å¦‚ï¼š `digger X-lab2017/open-digger -f x-lab chaoss`;
`digger X-lab2017/open-digger -f x-lab`

#### è¿‡æ»¤æŒ‡å®šç±»å‹çš„æŒ‡æ ‡

```bash
digger <example> -T <type>
```

`digger X-lab2017/open-digger -T index`;
`digger X-lab2017/open-digger -T metric index`

### å¯¼å‡ºæ–‡ä»¶

```bash
digger export <example> -m <metrics> [-t <time>]
```

- `<example>`ï¼šæŒ‡å®šä¸€ä¸ªä»“åº“æˆ–è€…ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼š`X-lab2017/open-digger`ã€`stevending1st`ã€‚
- `<metrics>`ï¼šæŒ‡å®šæŸ¥è¯¢çš„æŒ‡æ ‡ï¼Œæ”¯æŒå¤šä¸ªæŒ‡æ ‡ï¼Œå¤šä¸ªæŸ¥è¯¢ç”¨ `,` è¿æ¥ã€‚ä¾‹å¦‚ï¼š`openrank`ã€`openrank activity`ã€‚
  ç›®å‰æ”¯æŒå‚æ•°ï¼š`openrank`ã€`activity`ã€`attention`ã€`active_dates_and_times`ã€`stars`ã€`technical_fork`ã€`participants`ã€`new_contributors`ã€`new_contributors_detail`ã€`inactive_contributors`ã€`bus_factor`ã€`bus_factor_detail`ã€`issues_new`ã€`issues_closed`ã€`issue_comments`ã€`issue_response_time`ã€`issue_resolution_duration`ã€`issue_age`ã€`code_change_lines`ã€`code_change_lines_add`ã€`code_change_lines_remove`ã€`code_change_lines_sum`ã€`change_requests`ã€`change_requests_accepted`ã€`change_requests_reviews`ã€`change_request_response_time`ã€`change_request_resolution_duration`ã€`change_request_age`ã€`activity_details`ã€‚
- `<time>`ï¼šæŸ¥è¯¢çš„æ—¶é—´èŒƒå›´ï¼Œæ ¼å¼ä¸º yyyyMM æˆ– yyyyMM-yyyyMM ã€‚ä¾‹å¦‚ï¼š`202203`ã€`201912-202212`ã€‚

## ğŸ§© æ’ä»¶

æœ¬åº”ç”¨è®¡åˆ’æ”¯æŒ**å¼ºå¤§çš„æ’ä»¶åŠŸèƒ½**ï¼Œæ”¯æŒåœ¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œæ•°æ®å±•ç¤ºå’Œç”ŸæˆæŠ¥å‘Šç­‰æµç¨‹ä¸­è°ƒç”¨ api ä»¥è‡ªå®šä¹‰æ˜¾ç¤ºå†…å®¹ã€‚

ä¾‹å­ï¼š

```js
import Table from 'cli-table3';

export default {
  cli: {
    openrank: ({ metric, time, example, data }) => {
      const showData = [];
      for (let key in data) {
        showData.push([key, data[key]]);
      }

      const table = new Table({
        head: ['Time', 'openRank'],
        colWidths: [10, 20]
      });

      table.push(...showData);

      console.log(`${example}'s openrank(${time}):`);

      console.log(table.toString());
    }
  }
};
```

åœ¨é…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œï¼š

```bash
digger X-lab2017/open-digger -m openrank stars -t 202201-202206
```

ç»“æœï¼š

```bash
repo.owner: X-lab2017
repo.name: open-digger
repo.url:https://github.com/X-lab2017/open-digger
month: 202201-202206
X-lab2017/open-digger's openrank(202201-202206):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Time     â”‚ openrank           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2022-01  â”‚ 3.52               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2022-02  â”‚ 3.55               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2022-03  â”‚ 4.49               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2022-04  â”‚ 2.69               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2022-05  â”‚ 2.88               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2022-06  â”‚ 5.59               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
repo.stars:  {
  '2022-01': 5,
  '2022-02': 5,
  '2022-03': 102,
  '2022-04': 3,
  '2022-05': 4,
  '2022-06': 1
}
```

[1]: https://github.com/X-lab2017/open-digger
